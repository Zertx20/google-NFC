<!doctype html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Plaque Avis Google NFC Digifeel Algérie - Collectez Avis Clients</title>
    <meta name="description" content="Plaque Avis Google NFC Digifeel en Algérie. Collectez des avis clients en 3 secondes avec technologie NFC. Livraison 48h-72h. Paiement unique, aucun abonnement. Boostez votre réputation Google." />
    <meta name="keywords" content="plaque avis google nfc, digifeel, avis clients algérie, nfc algérie, réputation google, collecte avis" />
    <link rel="canonical" href="https://yourdomain.com/" />
    <meta name="last-modified" content="2025-01-01" />

    <!-- Open Graph -->
    <meta property="og:title" content="Plaque Avis Google NFC Digifeel Algérie - Collectez Avis Clients" />
    <meta property="og:description" content="Collectez des avis clients en 3 secondes avec la Plaque Avis Google NFC. Livraison rapide en Algérie." />
    <meta property="og:type" content="product" />
    <meta property="og:url" content="https://yourdomain.com/" />
    <meta property="og:image" content="https://static.readdy.ai/image/23c802d7f9313d983d4e57c3b073a22a/a6d6811163bcc17336b1418e22ff5673.jpeg" />

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="Plaque Avis Google NFC Digifeel Algérie" />
    <meta name="twitter:description" content="Collectez des avis clients en 3 secondes avec technologie NFC" />
    <meta name="twitter:image" content="https://static.readdy.ai/image/23c802d7f9313d983d4e57c3b073a22a/a6d6811163bcc17336b1418e22ff5673.jpeg" />

    <!-- Geo Tags -->
    <meta name="geo.region" content="DZ" />
    <meta name="geo.placename" content="Algérie" />

    <!-- Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/remixicon@4.5.0/fonts/remixicon.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" />

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">

    <!-- Schema.org Product Markup -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Product",
      "name": "Plaque Avis Google NFC - Digifeel",
      "image": "https://static.readdy.ai/image/23c802d7f9313d983d4e57c3b073a22a/a6d6811163bcc17336b1418e22ff5673.jpeg",
      "description": "Plaque NFC pour collecter des avis Google clients en 3 secondes. Compatible tous smartphones, installation instantanée.",
      "brand": {
        "@type": "Brand",
        "name": "Digifeel"
      },
      "offers": {
        "@type": "Offer",
        "price": "3500",
        "priceCurrency": "DZD",
        "availability": "https://schema.org/InStock",
        "url": "https://yourdomain.com/"
      },
      "aggregateRating": {
        "@type": "AggregateRating",
        "ratingValue": "4.9",
        "reviewCount": "122"
      }
    }
    </script>

    <!-- Meta Pixel Code (Optimized for React SPA) -->
    <script>
      // Meta Pixel Base Code - Load before React
      !function(f,b,e,v,n,t,s)
      {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
      n.callMethod.apply(n,arguments):n.queue.push(arguments)};
      if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
      n.queue=[];t=b.createElement(e);t.async=!0;
      t.src=v;s=b.getElementsByTagName(e)[0];
      s.parentNode.insertBefore(t,s)}(window, document,'script',
      'https://connect.facebook.net/en_US/fbevents.js');
      
      // Initialize Pixel
      fbq('init', '1910072642926314'); 
      
      // Track initial PageView
      fbq('track', 'PageView');
      
      // Store current path to prevent duplicate PageView
      window.lastTrackedPath = window.location.pathname;
      
      // Enhanced Purchase Tracking for React SPA
      window.trackPurchase = function() {
        try {
          // Robust selector for total price - handles multiple possible structures
          let totalValue = 0;
          
          // Try different selectors for total price
          const totalSelectors = [
            '.text-teal-600', // Current selector for total price
            '[class*="text-teal-600"]', // Backup selector
            '.text-2xl.font-bold', // Another possible selector
            'span:contains("DZD")' // Fallback selector
          ];
          
          for (const selector of totalSelectors) {
            const element = document.querySelector(selector);
            if (element && element.textContent) {
              // Extract numeric value from text like "3,500 DZD"
              const numericValue = element.textContent.replace(/[^\d]/g, '');
              totalValue = parseFloat(numericValue) || 0;
              if (totalValue > 0) break; // Found valid price
            }
          }
          
          // Fallback to default price if extraction fails
          if (totalValue === 0) {
            totalValue = 3500; // Default base price
          }
          
          // Track Purchase event
          fbq('track', 'Purchase', {
            value: totalValue,
            currency: 'DZD',
            content_type: 'product',
            content_name: 'Plaque Avis Google NFC'
          });
          
          console.log('Meta Pixel Purchase tracked:', { value: totalValue, currency: 'DZD' });
        } catch (error) {
          console.error('Error tracking Purchase:', error);
        }
      };
      
      // SPA PageView tracking for React Router
      window.trackPageView = function(pathname) {
        try {
          if (window.lastTrackedPath !== pathname) {
            fbq('track', 'PageView');
            window.lastTrackedPath = pathname;
            console.log('Meta Pixel PageView tracked for:', pathname);
          }
        } catch (error) {
          console.error('Error tracking PageView:', error);
        }
      };
    </script>
    <!-- End Meta Pixel -->

  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.tsx"></script>

    <!-- Enhanced Purchase Button Tracking -->
    <script>
      document.addEventListener('DOMContentLoaded', function() {
        // Wait for React to render, then attach event listeners
        setTimeout(function() {
          // Find all possible submit buttons (Commander buttons)
          const submitButtons = document.querySelectorAll('button[type="submit"]');
          
          submitButtons.forEach(function(button) {
            // Remove existing listeners to prevent duplicates
            button.removeEventListener('click', window.trackPurchase);
            
            // Add new listener with enhanced tracking
            button.addEventListener('click', function(event) {
              // Track purchase before form submission
              window.trackPurchase();
            });
          });
          
          console.log('Meta Pixel: Attached purchase tracking to', submitButtons.length, 'buttons');
        }, 1000); // Wait 1 second for React to mount
      });
      
      // Also handle dynamically added buttons (for SPA navigation)
      const observer = new MutationObserver(function(mutations) {
        mutations.forEach(function(mutation) {
          if (mutation.addedNodes.length) {
            const newButtons = document.querySelectorAll('button[type="submit"]:not([data-pixel-tracked])');
            newButtons.forEach(function(button) {
              button.setAttribute('data-pixel-tracked', 'true');
              button.addEventListener('click', window.trackPurchase);
            });
          }
        });
      });
      
      // Start observing for dynamic content
      observer.observe(document.body, {
        childList: true,
        subtree: true
      });
    </script>

    <!-- Meta Pixel NoScript -->
    <noscript>
      <img height="1" width="1" style="display:none"
      src="https://www.facebook.com/tr?id=1910072642926314&ev=PageView&noscript=1"/>
    </noscript>
  </body>
</html>
